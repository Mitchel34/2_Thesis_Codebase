{
  "command": "PYTHONPATH=. .venv/bin/python modeling/train_quick_transformer_torch.py --data data/clean/modeling/hourly_training_2010-01-01_2022-12-31.parquet --seq-len 168 --epochs 45 --batch-size 1024 --patience 8 --d-model 128 --num-heads 4 --num-layers 4 --conv-depth 4 --dropout 0.1 --lr 8e-4 --quantiles 0.05,0.1,0.25,0.5,0.75,0.9,0.95 --quantile-weights 0.2,0.3,0.6,1.2,0.6,0.3,0.2 --weight-nse 0.2 --weight-quantile 0.1 --flow-emphasis 0.25 --consistency-weight 2.5 --weight-pbias 0.025 --residual-bias-weight 0.002 --bias-shift-strategy scaled --bias-shift-alpha 0.1 --bias-shift-pbias-target 4.0 --bias-shift-qmin 0.05 --bias-shift-qmax 0.9 --bias-shift-weight-power -0.25 --weight-kge 0.02 --seed 2026 --no-compile --no-ranger --output-prefix batchsweep_bs1024_lr8e4_biasadapt_kge",
  "metrics": {
    "baseline": {
      "rmse": 5.971522001227854,
      "mae": 1.7772712879674828,
      "nse": 0.5188793817601274,
      "kge": 0.6385862839423266,
      "pbias": -5.994797959062143,
      "pearson_r": 0.7229607279606824,
      "spearman_r": 0.8319274069321457
    },
    "corrected": {
      "rmse": 5.167882763949538,
      "mae": 1.4168351255594323,
      "nse": 0.6396627156823085,
      "kge": 0.7969258803099125,
      "pbias": -0.5915240348126318,
      "pearson_r": 0.8090561639234245,
      "spearman_r": 0.9195839654094737
    },
    "rmse_residual": 5.167882919311523,
    "rmse_improvement_pct": 13.457862787963819,
    "output_prefix": "batchsweep_bs1024_lr8e4_biasadapt_kge",
    "quantiles": {
      "0.05": {
        "coverage": 0.0008248880509073768,
        "bias": -2.8581249713897705
      },
      "0.10": {
        "coverage": 0.017322649069054914,
        "bias": -2.4388773441314697
      },
      "0.25": {
        "coverage": 0.0802498232382748,
        "bias": -2.080085515975952
      },
      "0.50": {
        "coverage": 0.44873909969361303,
        "bias": -1.0698328018188477
      },
      "0.75": {
        "coverage": 0.7467593683714353,
        "bias": -0.011596557684242725
      },
      "0.90": {
        "coverage": 0.8742634928116898,
        "bias": 1.7165908813476562
      },
      "0.95": {
        "coverage": 0.9212821117134103,
        "bias": 3.082190990447998
      }
    },
    "bias_shift": {
      "strategy": "scaled",
      "alpha": 0.1,
      "qmin": 0.05,
      "qmax": 0.9,
      "weight_power": -0.25,
      "applied": -0.01892964615546019,
      "mean_bias": -0.16140685975551605,
      "pbias_percent": -4.6911627384692425,
      "scale": 1.1727906846173106,
      "samples": 7536,
      "status": "applied"
    }
  }
}
