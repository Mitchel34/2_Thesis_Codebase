{
  "command": "PYTHONPATH=. .venv/bin/python modeling/train_quick_transformer_torch.py --data data/clean/modeling/hourly_training_2010-01-01_2022-12-31.parquet --seq-len 168 --epochs 45 --batch-size 1024 --patience 8 --d-model 128 --num-heads 4 --num-layers 4 --conv-depth 4 --dropout 0.1 --lr 8e-4 --quantiles 0.05,0.1,0.25,0.5,0.75,0.9,0.95 --quantile-weights 0.2,0.3,0.6,1.2,0.6,0.3,0.2 --weight-nse 0.2 --weight-quantile 0.1 --flow-emphasis 0.25 --consistency-weight 2.5 --weight-pbias 0.03 --residual-bias-weight 0.002 --bias-shift-strategy scaled --bias-shift-alpha 0.1 --bias-shift-qmin 0.05 --bias-shift-qmax 0.9 --bias-shift-weight-power -0.25 --seed 2025 --no-compile --no-ranger --output-prefix batchsweep_bs1024_lr8e4_shift01",
  "metrics": {
    "baseline": {
      "rmse": 5.971522001227854,
      "mae": 1.7772712879674828,
      "nse": 0.5188793817601274,
      "kge": 0.6385862839423266,
      "pbias": -5.994797959062143,
      "pearson_r": 0.7229607279606824,
      "spearman_r": 0.8319274069321457
    },
    "corrected": {
      "rmse": 4.9223393905732955,
      "mae": 1.2655316185703993,
      "nse": 0.6730909041103212,
      "kge": 0.723668607706625,
      "pbias": -1.7263220343672052,
      "pearson_r": 0.8210538818631499,
      "spearman_r": 0.9283233880227015
    },
    "rmse_residual": 4.92233943939209,
    "rmse_improvement_pct": 17.569768820056712,
    "output_prefix": "batchsweep_bs1024_lr8e4_shift01",
    "quantiles": {
      "0.05": {
        "coverage": 0.0024746641527221306,
        "bias": -3.000260829925537
      },
      "0.10": {
        "coverage": 0.021329248173462174,
        "bias": -2.6326611042022705
      },
      "0.25": {
        "coverage": 0.10523214706575536,
        "bias": -2.0380630493164062
      },
      "0.50": {
        "coverage": 0.47984916332783406,
        "bias": -0.7658716440200806
      },
      "0.75": {
        "coverage": 0.7573650718831015,
        "bias": 0.8807677030563354
      },
      "0.90": {
        "coverage": 0.9457930709403723,
        "bias": 3.8581039905548096
      },
      "0.95": {
        "coverage": 0.9642941315107235,
        "bias": 7.014744281768799
      }
    },
    "bias_shift": {
      "strategy": "scaled",
      "alpha": 0.1,
      "qmin": 0.05,
      "qmax": 0.9,
      "weight_power": -0.25,
      "applied": -0.02101128250360489,
      "mean_bias": -0.2101128250360489,
      "samples": 7536,
      "status": "applied"
    }
  }
}
